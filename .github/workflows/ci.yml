name: CI/CD

on:
  push:
    branches: [ main, feature/* ]
  pull_request:
    branches: [ main ]

jobs:
  # Backend Tests
  backend:
    name: Backend CI
    runs-on: ubuntu-latest
    
    steps:
    - uses: actions/checkout@v4
    
    - name: Setup Bun
      uses: oven-sh/setup-bun@v1
      with:
        bun-version: latest
    
    - name: Install dependencies
      run: bun install
    
    - name: Run linter
      run: bun run lint
    
    - name: Run type check
      run: bun run check

  # Frontend Tests
  frontend:
    name: Frontend CI
    runs-on: ubuntu-latest
    
    steps:
    - uses: actions/checkout@v4
    
    - name: Setup Bun
      uses: oven-sh/setup-bun@v1
      with:
        bun-version: latest
    
    - name: Install dependencies
      working-directory: ./frontend
      run: bun install
    
    - name: Run linter
      working-directory: ./frontend
      run: bun run lint
    
    - name: Build
      working-directory: ./frontend
      run: bun run build
    
    - name: Check build size
      working-directory: ./frontend
      run: |
        echo "Build output size:"
        du -sh dist/
        echo "Build files:"
        ls -lh dist/
