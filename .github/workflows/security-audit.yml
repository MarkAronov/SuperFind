name: "Security Audit"

on:
  push:
    branches: [ "main", "develop" ]
  pull_request:
    branches: [ "main", "develop" ]
  schedule:
    - cron: '0 2 * * *' # Daily at 2 AM UTC

jobs:
  bun-audit-backend:
    name: Bun Audit - Backend
    runs-on: ubuntu-latest
    uses: ./.github/workflows/reusable/bun-workflow.yml
    with:
      working-directory: '.'
      bun-version: 'latest'
      install: 'true'
      run-audit: 'true'

  bun-audit-frontend:
    name: Bun Audit - Frontend
    runs-on: ubuntu-latest
    uses: ./.github/workflows/reusable/bun-workflow.yml
    with:
      working-directory: frontend
      bun-version: 'latest'
      install: 'true'
      run-audit: 'true'

  bun-audit-sdk:
    name: Bun Audit - SDK
    runs-on: ubuntu-latest
    uses: ./.github/workflows/reusable/bun-workflow.yml
    with:
      working-directory: sdk/typescript
      bun-version: 'latest'
      install: 'true'
      run-audit: 'true'
